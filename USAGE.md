# 使用说明 (Usage Guide)

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行实验

#### 使用真实MNIST数据（需要网络连接）

```bash
python main.py
```

这将下载MNIST数据集并运行完整实验。

#### 使用合成数据（无需网络）

```bash
python demo.py
```

这将生成模拟数据用于演示和测试。

### 3. 自定义参数

```bash
# 测试特定维度
python main.py --dimensions 10 20 50 100

# 使用更大的样本
python main.py --sample-size 20000

# 使用完整数据集
python main.py --sample-size 0

# 跳过可视化（仅显示表格）
python main.py --no-viz
```

## 输出说明

### 控制台输出

程序会实时显示：
1. 数据加载进度
2. 每个维度的测试进度
3. 每个方法组合的准确率和训练时间
4. 最终的对比表格

### 可视化文件

程序会生成三个PNG图像文件：

1. **accuracy_comparison.png**: 准确率对比图
   - 左图：PCA降维 + 各分类器
   - 右图：LDA降维 + 各分类器
   - 显示准确率随维度变化的趋势

2. **time_comparison.png**: 训练时间对比图
   - 左图：PCA降维 + 各分类器的训练时间
   - 右图：LDA降维 + 各分类器的训练时间
   - 显示计算复杂度随维度的增长

3. **accuracy_heatmap.png**: 准确率热力图
   - 以颜色编码显示所有结果
   - 便于快速识别最佳配置

## 实验配置

### 降维方法

- **PCA (主成分分析)**
  - 无监督方法
  - 可以降到任意维度
  - 保留最大方差方向

- **LDA (线性判别分析)**
  - 有监督方法
  - 最多降到c-1维（c为类别数）
  - 对于MNIST（10类），最多9维
  - 优化类别可分性

### 分类器

- **QDF (RDA)**: 正则化判别分析
  - α=0.5: 协方差收缩参数
  - β=0.5: 对角化参数
  
- **QDF (MQDF)**: 改进二次判别函数
  - k=dim/2: 保留的主成分数

- **KNN**: K近邻分类器
  - k=5: 使用5个近邻
  - algorithm='kd_tree': 使用KD树加速

## 性能优化建议

### 对于大数据集

1. 使用`--sample-size`限制样本数
2. 减少测试的维度数量
3. 使用`--no-viz`跳过可视化

### 对于快速测试

```bash
# 快速测试（2000样本，3个维度）
python main.py --dimensions 10 30 50 --sample-size 2000
```

### 对于完整实验

```bash
# 使用更多样本和维度
python main.py --dimensions 5 10 20 30 50 100 150 200 --sample-size 30000
```

## 理解结果

### 准确率趋势

- **PCA**: 通常随维度增加而提升，在100-200维达到平台
- **LDA**: 在低维度（5-9维）即可达到较好效果
- **KNN**: 通常表现最好但对维度敏感
- **QDF**: 在中低维度表现稳定

### 时间复杂度

- **QDF训练**: O(nd² + d³)，随维度快速增长
- **KNN训练**: O(n log n)，建立KD树
- **MQDF**: 比RDA略快，减少了计算量

### 方法选择建议

| 场景 | 推荐方法 | 原因 |
|------|---------|------|
| 极低维度需求 (≤10) | LDA + KNN | LDA优化类别可分性 |
| 中等维度 (10-50) | PCA + KNN | 平衡性能和效率 |
| 高维度 (≥100) | PCA + KNN | PCA灵活性高 |
| 快速预测需求 | LDA + QDF | 训练后预测快 |
| 内存受限 | MQDF | 参数量更少 |

## 常见问题

### Q: 无法下载MNIST数据？

A: 使用demo.py运行合成数据实验，或手动下载MNIST并使用本地加载。

### Q: 内存不足？

A: 减少`--sample-size`参数，或减少测试的维度数量。

### Q: 为什么LDA的维度被限制？

A: LDA最多可以提取c-1个判别方向，其中c是类别数。对于10类MNIST，最多9维。

### Q: 合成数据的结果准确率太高？

A: 合成数据比真实MNIST简单。真实MNIST上，准确率通常在85%-97%之间，取决于维度和方法。

## 扩展实验

### 尝试不同参数

编辑代码修改以下参数：

1. **QDF正则化参数**
   ```python
   qdf = QDF(reg_type='rda', alpha=0.3, beta=0.7)  # 更强正则化
   ```

2. **KNN邻居数**
   ```python
   knn = KNN(n_neighbors=10)  # 使用更多邻居
   ```

3. **MQDF主成分数**
   ```python
   qdf = QDF(reg_type='mqdf', k_mqdf=dim//3)  # 使用更少主成分
   ```

### 添加其他数据集

可以修改`data_loader.py`来支持其他数据集，如：
- Fashion-MNIST
- CIFAR-10
- 自定义数据集

## 引用实验结果

如果使用此代码进行实验，建议在报告中包含：
1. 使用的参数设置
2. 数据集大小
3. 生成的可视化图表
4. 对结果的分析和讨论
